import * as d3 from 'd3';
import { Subject, fromEvent } from 'rxjs';
import { debounceTime } from 'rxjs/operators';
import { D3NodeBasicParser } from './@items';
import { calcGFit, setPattern, addDefaultDefs, buildTree } from './d3x/d3x';
var D3OrgChart = /** @class */ (function () {
    function D3OrgChart(prContainer, prOptions) {
        var _this = this;
        var _a, _b;
        //#region Default Options
        this.options = {
            backgroundColor: '#03A3C5',
            nodeParser: new D3NodeBasicParser(),
            data: [],
            defaultFont: 'Tahoma',
            nodeHorizontalSpaceScale: 0.5,
            nodeVerticalSpaceScale: 0.8
        };
        // protected allNodes: any;
        this._data = [];
        //#endregion
        this.zoomFunc = d3.zoom().scaleExtent([0.1, 20]).on("zoom", function (d) { return _this.zoomed(); });
        this.currentZoom = 1;
        //#region Events
        // node click
        this.onNodeClick = new Subject();
        var me = this;
        // init container
        me.container = d3.select(prContainer);
        //If Data argument passed - then set it
        if ((_a = prOptions) === null || _a === void 0 ? void 0 : _a.data)
            me._data = prOptions.data;
        // setting parser
        me._nodeParser = ((_b = prOptions) === null || _b === void 0 ? void 0 : _b.nodeParser) || me.options.nodeParser;
        // applying options
        me.options = Object.assign(me.options, prOptions);
        // monitor resize
        fromEvent(prContainer, 'resize')
            .pipe(debounceTime(300)).subscribe(function () {
            // HDC - VER this.prepareCanvas();
            console.log('resize container');
            _this.render();
        });
        fromEvent(window, 'resize')
            .pipe(debounceTime(300)).subscribe(function () {
            // HDC - VER this.prepareCanvas();
            console.log('resize window');
            _this.render();
        });
    }
    Object.defineProperty(D3OrgChart.prototype, "nodeParser", {
        get: function () {
            if (!this._nodeParser)
                this._nodeParser = new D3NodeBasicParser();
            return this._nodeParser;
        },
        set: function (parser) {
            this._nodeParser = parser;
            // this.render();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(D3OrgChart.prototype, "data", {
        get: function () {
            return this._data || [];
        },
        set: function (data) {
            this._data = data;
            // this.render()
        },
        enumerable: true,
        configurable: true
    });
    D3OrgChart.prototype.render = function () {
        var me = this;
        // preparing svg
        me.prepareCanvas();
        // if no data then return
        if (!me.data.length)
            return;
        // preparing data
        me.prepareData();
        // showing nodes
        me.showNodes();
        return this;
    };
    // preparing canvas
    D3OrgChart.prototype.prepareCanvas = function () {
        var _this = this;
        var me = this;
        //Drawing containers
        var containerRect = me.container.node().getBoundingClientRect();
        // console.log('Container resct: ', containerRect)
        me.svg = me.container.selectAll('svg')
            .data([{ id: 'svg' }], function (d) { return d.id; })
            .join(function (enter) {
            return enter
                .append('svg')
                .attr('class', 'svg-chart-container')
                .attr('font-family', me.options.defaultFont)
                // .call(d3.zoom().on("zoom", d => this.zoomed()))
                .call(_this.zoomFunc)
                .on("dblclick.zoom", null)
                .attr('cursor', 'move')
                .style('background-color', me.options.backgroundColor);
        }, function (update) {
            return update
                .attr('width', containerRect.width)
                .attr('height', containerRect.height)
                .attr('font-family', me.options.defaultFont)
                .style('background-color', me.options.backgroundColor);
        })
            .attr('width', containerRect.width)
            .attr('height', containerRect.height)
            .attr('font-family', me.options.defaultFont)
            .style('background-color', me.options.backgroundColor);
        //Add container g element
        me.chart = me.svg.selectAll('g.chart')
            .data([{ id: 'chart' }], function (d) { return d.id; })
            .join(function (enter) { return enter
            .append('g')
            .attr('class', 'chart')
            .attr('transform', "translate(0,0)"); }, function (update) { return update; });
        if (!me.lastTransform)
            me.svg.transition().duration(200).call(me.zoomFunc.transform, d3.zoomIdentity.translate(containerRect.width / 2, this.nodeParser.height).scale(1));
        //Add container g element
        me.tb = me.svg.selectAll('g.toolbar')
            .data([{ id: 'toolbar' }], function (d) { return d.id; })
            .join(function (enter) { return enter
            .append('g')
            .attr('class', 'toolbar')
            .attr('transform', "translate(10,10)")
            .append('rect')
            .attr('width', 30)
            .attr('height', 30)
            .attr('fill', 'url(#img-fit-icon)')
            .attr('cursor', 'pointer')
            .on('click', function () { return me.fit(); }); }, function (update) { return update; });
        me.prepareDefs();
    };
    // preparing defs
    D3OrgChart.prototype.prepareDefs = function () {
        var me = this;
        // defs
        me.defs = me.svg.selectAll('defs.globalDefs')
            .data([{ id: 'defs' }], function (d) { return d.id; })
            .join(function (enter) {
            var defs = enter.append('defs').attr('class', 'globalDefs');
            addDefaultDefs(defs, {
                'expand-icon': {
                    type: 'icon',
                    backgroundColor: '#05C356',
                    scale: 0.6,
                    color: '#EAFA48',
                    name: 'faPlus'
                },
                'collapse-icon': {
                    type: 'icon',
                    backgroundColor: '#D10303',
                    scale: 0.6,
                    color: '#EAFA48',
                    name: 'faMinus'
                },
                'fit-icon': {
                    type: 'icon',
                    backgroundColor: '#074EF3',
                    scale: 0.9,
                    color: '#EAFA48',
                    name: 'faExpand'
                },
                'default-node-img': me.nodeParser.defaultImage
            }, me.nodeParser);
            //addDefs(defs, me.defsElements);
            return defs;
        }, function (update) { return update; });
    };
    // preparing data
    D3OrgChart.prototype.prepareData = function () {
        var me = this;
        // if no data return 
        if (!me.data.length)
            return;
        // Convert flat data to hierarchical
        if (!me.root) {
            try { // preventing multiple root
                me.root = d3.stratify().id(function (_a) {
                    var nodeId = _a.nodeId;
                    return nodeId;
                }).parentId(function (_a) {
                    var parentNodeId = _a.parentNodeId;
                    return parentNodeId;
                })(me.data);
            }
            catch (err) {
                me.root = d3.stratify().id(function (_a) {
                    var nodeId = _a.nodeId;
                    return nodeId;
                }).parentId(function (_a) {
                    var parentNodeId = _a.parentNodeId;
                    return parentNodeId;
                })([{
                        nodeId: 'root',
                        parentNodeId: '',
                        title: 'Error',
                        description: err.message || err,
                        nodeImage: {
                            type: 'base64',
                            data: me.nodeParser.errorBase64Icon
                        }
                    }]);
            }
        }
        // preparing treemap
        var containerRect = me.container.node().getBoundingClientRect();
        me.treemap = d3.tree() //.size([containerRect.width || 250, containerRect.height])
            .nodeSize([
            (me.nodeParser.width + (this.nodeParser.width * me.options.nodeHorizontalSpaceScale || 0.5)) * 0,
            (me.nodeParser.height + (this.nodeParser.height * me.options.nodeVerticalSpaceScale || 0.8)) * 0
        ])
            .separation(function (a, b) {
            return 1;
        });
        // me.allNodes = me.treemap(me.root).descendants();
        me.checkExpanded(me.root);
    };
    // showing nodes
    D3OrgChart.prototype.showNodes = function (prNode) {
        var _this = this;
        if (prNode === void 0) { prNode = null; }
        var me = this;
        if (!prNode)
            prNode = me.root;
        var nodeRef = {
            x: prNode.x || 0,
            y: prNode.y || 0,
            parent: prNode.parent
        };
        // console.log('Node Before: ', nodeRef.x);
        var updatePosition = {
            x: prNode.x || 0,
            y: prNode.y || 0
        };
        //  Assigns the x and y position for the nodes
        var treeData = me.treemap(me.root);
        // it is necesary for scope 
        var drawNodes = function (container) { return me.nodeParser.drawNodes(container, me.onNodeClick); };
        var drawCollapser = function (nodeGroup) {
            nodeGroup.append('circle')
                .attr('class', 'collapser')
                .attr('cx', me.nodeParser.width / 2)
                .attr('cy', me.nodeParser.height)
                .attr('r', 15)
                .attr('stroke', 'black')
                .attr('stroke-width', 2)
                .on('click', function (node) {
                // console.log('Node X: ', node.x)
                d3.event.preventDefault();
                me.expand(node, true);
            });
        };
        // console.log('Node ref: ', prNode.x, nodeRef.x, nodeRef )
        var nodes = treeData.descendants();
        // probanding
        buildTree(me.root, {
            w: me.nodeParser.width + (this.nodeParser.width * me.options.nodeHorizontalSpaceScale || 0.5),
            h: me.nodeParser.height + (this.nodeParser.height * me.options.nodeVerticalSpaceScale || 0.8)
        });
        // console.log('Nodes: ', nodes);
        // preparing all definitions for nodes
        me.defs.selectAll('pattern.node')
            .data(nodes, function (d) { return d.data.nodeId; })
            .join(function (enter) {
            return enter.filter(function (d) { return d.data.nodeImage != null; })
                .append('pattern').attr('class', 'node')
                .each(function (nodeData, i, enterNodes) {
                // adding pattern
                var pattern = d3.select(enterNodes[i]);
                setPattern(pattern, nodeData.data, me.nodeParser);
            });
        }, function (update) { return update; }, function (exit) { return exit
            .transition()
            .duration(me.nodeParser.transitionDuration)
            .style("opacity", 0)
            .remove(); });
        // rendering nodes
        var nodeStartPosition = function (d) {
            if (nodeRef) {
                return "translate(" + (nodeRef.x - (me.nodeParser.width / 2)) + "," + nodeRef.y + ")";
            }
            if (!d.parent)
                return "translate(" + (d.x - (me.nodeParser.width / 2)) + "," + d.y + ")";
            return "translate(" + (d.parent.x - (me.nodeParser.width / 2)) + "," + d.parent.y + ")";
        };
        var collapserStartPosition = function (d) {
            if (nodeRef)
                return nodeRef;
            if (!d.parent)
                return d;
            return d.parent;
        };
        var nodePosition = function (params) {
            return "translate(" + (params.x - (me.nodeParser.width / 2)) + "," + params.y + ")";
        };
        var collapserPosition = function (params) {
            return "translate(" + params.x + "," + params.y + ")";
        };
        var expandIconVisible = function (d) { return (d.children || d._children) ? 'visible' : 'hidden'; };
        var expandIcon = function (d) { return expandIconVisible(d) == 'visible' ? (d.data.expanded ? "url(#img-collapse-icon)" : "url(#img-expand-icon)") : ''; };
        var collapserCursor = function (d) { return expandIconVisible(d) == 'visible' ? (d.data.expanded ? "zoom-out" : "zoom-in") : 'default'; };
        me.chart.selectAll('g.node')
            .data(nodes, function (d) { return d.data.nodeId; })
            .join(function (enter) {
            return enter.append('g')
                .style("opacity", 0)
                .attr('class', 'node')
                .attr('cursor', 'pointer')
                .attr('transform', nodeStartPosition)
                .call(drawNodes)
                // .call(drawCollapser)
                .on('dblclick', function (node) {
                var containerRect = me.container.node().getBoundingClientRect();
                me.traslateTo((containerRect.width / 2) - node.x, ((containerRect.height - me.nodeParser.height) / 2) - node.y);
            });
        }, function (update) { return update; }, function (exit) {
            return exit
                .transition()
                .duration(me.nodeParser.transitionDuration)
                .attr('transform', nodePosition(prNode))
                .style("opacity", 0)
                .remove();
        })
            .transition().duration(me.nodeParser.transitionDuration)
            .style("opacity", 1)
            .attr('transform', nodePosition);
        //.selectAll('circle.collapser')
        //.attr('visibility', expandIconVisible)
        //.attr('fill', expandIcon)
        me.chart.selectAll('circle.collapser')
            .data(nodes, function (d) { return d.data.nodeId; })
            .join(function (enter) {
            return enter.append('circle')
                .attr('class', 'collapser')
                .style("opacity", 0)
                .attr('cx', function (d) { return collapserStartPosition(d).x; })
                .attr('cy', function (d) { return collapserStartPosition(d).y + me.nodeParser.height; })
                .attr('r', 15)
                .attr('stroke', 'black')
                .attr('stroke-width', 2)
                .on('click', function (node) {
                // console.log('Node X: ', node.x)
                d3.event.preventDefault();
                me.expand(node, true);
            });
        }, function (update) { return update; }, function (exit) {
            return exit
                .transition().duration(me.nodeParser.transitionDuration)
                .attr('cx', function (d) { return collapserStartPosition(d).x; })
                .attr('cy', function (d) { return collapserStartPosition(d).y + me.nodeParser.height; })
                .style("opacity", 0)
                .remove();
        })
            .transition().duration(me.nodeParser.transitionDuration)
            .style("opacity", 1)
            .attr('cx', function (d) { return d.x; })
            .attr('cy', function (d) { return d.y + me.nodeParser.height; })
            .attr('visibility', expandIconVisible)
            .attr('fill', expandIcon)
            .attr('cursor', collapserCursor);
        // rendering links
        var pathStartingDiagonal = function (d) {
            return _this.linkPath(d, d);
        };
        var pathDiagonal = function (d) {
            var target = { x: d.parent.x, y: d.parent.y + me.nodeParser.height };
            return _this.linkPath(d, d.parent);
        };
        me.chart.selectAll('path.link')
            .data(nodes.slice(1), function (d) { return d.data.nodeId; })
            .join(function (enter) {
            return enter
                .insert('path', 'g')
                .attr('class', 'link')
                .attr('fill', 'none')
                .attr('stroke', 'blue')
                .attr('stroke-width', 2)
                .attr('d', pathStartingDiagonal(nodeRef));
        }, function (update) { return update; }, function (exit) {
            return exit
                .transition().duration(me.nodeParser.transitionDuration)
                .attr('d', pathStartingDiagonal(prNode))
                .remove();
        })
            .transition().duration(me.nodeParser.transitionDuration)
            .attr('d', pathDiagonal);
    };
    // Zoom handler function
    D3OrgChart.prototype.zoomed = function () {
        var me = this;
        // Saving d3 event's transform object
        me.lastTransform = d3.event.transform;
        // Reposition and rescale chart accordingly
        if (isNaN(me.lastTransform.k) || isNaN(me.lastTransform.x) || isNaN(me.lastTransform.y))
            return;
        me.chart.attr('transform', d3.event.transform);
    };
    D3OrgChart.prototype._onNodeClick = function (nodeId, node) {
        this.onNodeClick.next({ id: nodeId, node: node });
    };
    //#endregion
    // Generate custom diagonal - play with it here - https://observablehq.com/@bumbeishvili/curved-edges?collection=@bumbeishvili/work-components
    D3OrgChart.prototype.linkPath = function (source, target) {
        var me = this;
        // Calculate some variables based on source and target (s,t) coordinates
        var x = source.x;
        var y = source.y;
        var ex = target.x;
        var ey = target.y + me.nodeParser.height;
        var linkHeight = 25;
        var curveRadius = Math.abs(x - ex) != 0 ? 15 : 0;
        var xrvs = ex - x < 0 ? -1 : 1;
        var yrvs = ey - y < 0 ? -1 : 1;
        var w = Math.abs(ex - x) - (curveRadius * 2);
        var path = "\n      M " + x + " " + y + "\n      L " + x + " " + (y + (linkHeight * yrvs)) + "\n      C " + x + " " + (y + ((linkHeight + curveRadius) * yrvs)) + " " + x + " " + (y + ((linkHeight + curveRadius) * yrvs)) + " " + (x + (curveRadius * xrvs)) + " " + (y + ((linkHeight + curveRadius) * yrvs)) + "\n      L " + (x + ((w + curveRadius) * xrvs)) + " " + (y + ((linkHeight + curveRadius) * yrvs)) + "\n      C " + ex + "  " + (y + ((linkHeight + curveRadius) * yrvs)) + " " + ex + "  " + (y + ((linkHeight + curveRadius) * yrvs)) + " " + ex + " " + (y + ((linkHeight + curveRadius) * yrvs) + (curveRadius * yrvs)) + "\n      L " + ex + " " + ey + "\n    ";
        return path;
    };
    D3OrgChart.prototype.checkExpanded = function (node) {
        var me = this;
        // checking expanded
        if (node.data.expanded) {
            if (!node.children && node._children) {
                node.children = node._children;
                node._children = null;
            }
        }
        else { // collapsed
            if (node.children) {
                node._children = node.children;
                node.children = null;
            }
        }
        // checking children
        (node.children || node._children || []).forEach(function (current) { return me.checkExpanded(current); });
    };
    D3OrgChart.prototype.expand = function (node, toggle) {
        if (toggle === void 0) { toggle = false; }
        var me = this;
        var nodeRef = Object.assign(node);
        // if toggle - lets toggle
        if (toggle)
            node.data.expanded = !node.data.expanded;
        // checking expanded
        if (node.data.expanded) {
            if (!node.children && node._children) {
                node.children = node._children;
                node._children = null;
            }
        }
        else { // collapsed
            if (node.children) {
                node._children = node.children;
                node.children = null;
            }
        }
        // expand(node.children, node.data.expanded);
        // console.log('Before expand: ', nodeRef.x,  node.x)
        if (toggle)
            me.showNodes(node);
    };
    D3OrgChart.prototype.traslateTo = function (prX, prY) {
        var me = this;
        me.svg
            .transition().duration(me.nodeParser.transitionDuration)
            .call(me.zoomFunc.transform, d3.zoomIdentity.translate(prX, prY));
    };
    D3OrgChart.prototype.fit = function () {
        var me = this;
        // const zoom = d3.zoom().on("zoom", d => this.zoomed())
        if (!me.root)
            return;
        var fit = calcGFit(me.chart, me.svg, me.root, me.nodeParser);
        me.svg.transition().duration(me.nodeParser.transitionDuration).call(me.zoomFunc.transform, d3.zoomIdentity.translate(fit.x, fit.y).scale(fit.scale));
    };
    D3OrgChart.prototype.setOptions = function (prOptions) {
        var me = this;
        me.options = Object.assign(me.options, prOptions);
    };
    return D3OrgChart;
}());
export { D3OrgChart };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZDMtb3JnLWNoYXJ0LmNsYXNzLmpzIiwic291cmNlUm9vdCI6Im5nOi8vYmUtb3JnY2hhcnQvIiwic291cmNlcyI6WyJsaWIvY2xhc2Vzcy9kMy1vcmctY2hhcnQuY2xhc3MudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxLQUFLLEVBQUUsTUFBTSxJQUFJLENBQUM7QUFFekIsT0FBTyxFQUFFLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDMUMsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzlDLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUU3QyxPQUFPLEVBQUUsUUFBUSxFQUFFLFVBQVUsRUFBRSxjQUFjLEVBQUUsU0FBUyxFQUFhLE1BQU0sV0FBVyxDQUFDO0FBWXZGO0lBd0RFLG9CQUFZLFdBQXdCLEVBQUUsU0FBOEI7UUFBcEUsaUJBb0NDOztRQTNGRCx5QkFBeUI7UUFDZixZQUFPLEdBQXVCO1lBQ3RDLGVBQWUsRUFBRSxTQUFTO1lBQzFCLFVBQVUsRUFBRSxJQUFJLGlCQUFpQixFQUFFO1lBQ25DLElBQUksRUFBRSxFQUFFO1lBQ1IsV0FBVyxFQUFFLFFBQVE7WUFDckIsd0JBQXdCLEVBQUUsR0FBRztZQUM3QixzQkFBc0IsRUFBRSxHQUFHO1NBQzVCLENBQUE7UUE2QkQsMkJBQTJCO1FBRWpCLFVBQUssR0FBYyxFQUFFLENBQUM7UUFTaEMsWUFBWTtRQUVaLGFBQVEsR0FBRyxFQUFFLENBQUMsSUFBSSxFQUFFLENBQUMsV0FBVyxDQUFDLENBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLE1BQU0sRUFBRSxVQUFBLENBQUMsSUFBSSxPQUFBLEtBQUksQ0FBQyxNQUFNLEVBQUUsRUFBYixDQUFhLENBQUMsQ0FBQztRQUUzRSxnQkFBVyxHQUFXLENBQUMsQ0FBQztRQStaeEIsZ0JBQWdCO1FBQ2hCLGFBQWE7UUFDYixnQkFBVyxH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LEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQ3pELENBQUM7SUFDSixDQUFDO0lBRUQsK0JBQVUsR0FBVixVQUFXLFNBQXNDO1FBQy9DLElBQU0sRUFBRSxHQUFHLElBQUksQ0FBQztRQUNoQixFQUFFLENBQUMsT0FBTyxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxTQUFTLENBQUMsQ0FBQztJQUNwRCxDQUFDO0lBQ0gsaUJBQUM7QUFBRCxDQUFDLEFBL2pCRCxJQStqQkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBkMyBmcm9tICdkMyc7XHJcbmltcG9ydCB7IElEM05vZGUsIElJbWFnZURlZiB9IGZyb20gJy4uL2ludGVyZmFjZXMnO1xyXG5pbXBvcnQgeyBTdWJqZWN0LCBmcm9tRXZlbnQgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgZGVib3VuY2VUaW1lIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBEM05vZGVCYXNpY1BhcnNlciB9IGZyb20gJy4vQGl0ZW1zJztcclxuXHJcbmltcG9ydCB7IGNhbGNHRml0LCBzZXRQYXR0ZXJuLCBhZGREZWZhdWx0RGVmcywgYnVpbGRUcmVlLCBJUm9vdE5vZGUgfSBmcm9tICcuL2QzeC9kM3gnO1xyXG5pbXBvcnQgeyBCYXNlVHlwZSB9IGZyb20gJ2QzJztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSUQzT3JnQ2hhcnRPcHRpb25zIHtcclxuICBub2RlUGFyc2VyPzogRDNOb2RlQmFzaWNQYXJzZXI7XHJcbiAgZGF0YT86IElEM05vZGVbXTtcclxuICBiYWNrZ3JvdW5kQ29sb3I/OiBzdHJpbmc7XHJcbiAgZGVmYXVsdEZvbnQ/OiBzdHJpbmc7XHJcbiAgbm9kZUhvcml6b250YWxTcGFjZVNjYWxlPzogbnVtYmVyO1xyXG4gIG5vZGVWZXJ0aWNhbFNwYWNlU2NhbGU/OiBudW1iZXI7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBEM09yZ0NoYXJ0IHtcclxuICAvLyNyZWdpb24gRGVmYXVsdCBPcHRpb25zXHJcbiAgcHJvdGVjdGVkIG9wdGlvbnM6IElEM09yZ0NoYXJ0T3B0aW9ucyA9IHtcclxuICAgIGJhY2tncm91bmRDb2xvcjogJyMwM0EzQzUnLFxyXG4gICAgbm9kZVBhcnNlcjogbmV3IEQzTm9kZUJhc2ljUGFyc2VyKCksXHJcbiAgICBkYXRhOiBbXSxcclxuICAgIGRlZmF1bHRGb250OiAnVGFob21hJyxcclxuICAgIG5vZGVIb3Jpem9udGFsU3BhY2VTY2FsZTogMC41LFxyXG4gICAgbm9kZVZlcnRpY2FsU3BhY2VTY2FsZTogMC44XHJcbiAgfVxyXG4gIC8vI2VuZHJlZ2lvblxyXG5cclxuICAvLyNyZWdpb24gIE5PREUgUEFSU0VSXHJcbiAgcHJvdGVjdGVkIF9ub2RlUGFyc2VyOiBEM05vZGVCYXNpY1BhcnNlcjtcclxuICBnZXQgbm9kZVBhcnNlcigpOiBEM05vZGVCYXNpY1BhcnNlciB7XHJcbiAgICBpZiAoIXRoaXMuX25vZGVQYXJzZXIpIHRoaXMuX25vZGVQYXJzZXIgPSBuZXcgRDNOb2RlQmFzaWNQYXJzZXIoKTtcclxuICAgIHJldHVybiB0aGlzLl9ub2RlUGFyc2VyO1xyXG4gIH1cclxuICBzZXQgbm9kZVBhcnNlcihwYXJzZXI6IEQzTm9kZUJhc2ljUGFyc2VyKSB7XHJcbiAgICB0aGlzLl9ub2RlUGFyc2VyID0gcGFyc2VyO1xyXG4gICAgLy8gdGhpcy5yZW5kZXIoKTtcclxuICB9XHJcbiAgLy8jZW5kcmVnaW9uXHJcblxyXG4gIC8vI3JlZ2lvbiBTVkcgY29tcG9uZW50c1xyXG4gIHByb3RlY3RlZCBjb250YWluZXI6IGQzLlNlbGVjdGlvbjxIVE1MRWxlbWVudCwgYW55LCBhbnksIGFueT47XHJcbiAgcHJvdGVjdGVkIHN2ZzogZDMuU2VsZWN0aW9uPFNWR0VsZW1lbnQsIHVua25vd24sIEhUTUxFbGVtZW50LCB1bmtub3duPjtcclxuICBwcm90ZWN0ZWQgdGI6IGQzLlNlbGVjdGlvbjxhbnksIGFueSwgYW55LCBhbnk+O1xyXG5cclxuICBwcm90ZWN0ZWQgY2hhcnQ6IGQzLlNlbGVjdGlvbjxTVkdHRWxlbWVudCwgYW55LCBCYXNlVHlwZSwgYW55PjtcclxuICAvLyBwcm90ZWN0ZWQgY2VudGVyRzogZDMuU2VsZWN0aW9uPGFueSwgYW55LCBhbnksIGFueT47XHJcbiAgcHJvdGVjdGVkIGRlZnM6IGQzLlNlbGVjdGlvbjxhbnksIGFueSwgYW55LCBhbnk+O1xyXG5cclxuICBwcm90ZWN0ZWQgbGFzdFRyYW5zZm9ybTogYW55O1xyXG4gIC8vI2VuZHJlZ2lvblxyXG5cclxuICAvLyNyZWdpb24gREFUQVxyXG4gIHByb3RlY3RlZCByb290OiBkMy5IaWVyYXJjaHlQb2ludE5vZGU8SUQzTm9kZT47XHJcbiAgLy8gcHJvdGVjdGVkIGFsbE5vZGVzOiBhbnk7XHJcblxyXG4gIHByb3RlY3RlZCBfZGF0YTogSUQzTm9kZVtdID0gW107XHJcbiAgZ2V0IGRhdGEoKTogSUQzTm9kZVtdIHtcclxuICAgIHJldHVybiB0aGlzLl9kYXRhIHx8IFtdO1xyXG4gIH1cclxuXHJcbiAgc2V0IGRhdGEoZGF0YTogSUQzTm9kZVtdKSB7XHJcbiAgICB0aGlzLl9kYXRhID0gZGF0YTtcclxuICAgIC8vIHRoaXMucmVuZGVyKClcclxuICB9XHJcbiAgLy8jZW5kcmVnaW9uXHJcblxyXG4gIHpvb21GdW5jID0gZDMuem9vbSgpLnNjYWxlRXh0ZW50KFswLjEsIDIwXSkub24oXCJ6b29tXCIsIGQgPT4gdGhpcy56b29tZWQoKSk7XHJcblxyXG4gIGN1cnJlbnRab29tOiBudW1iZXIgPSAxO1xyXG4gIHRyZWVtYXA6IGQzLlRyZWVMYXlvdXQ8SUQzTm9kZT47XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByQ29udGFpbmVyOiBIVE1MRWxlbWVudCwgcHJPcHRpb25zPzogSUQzT3JnQ2hhcnRPcHRpb25zKSB7XHJcbiAgICBjb25zdCBtZSA9IHRoaXM7XHJcblxyXG4gICAgLy8gaW5pdCBjb250YWluZXJcclxuICAgIG1lLmNvbnRhaW5lciA9IGQzLnNlbGVjdChwckNvbnRhaW5lcik7XHJcblxyXG4gICAgLy9JZiBEYXRhIGFyZ3VtZW50IHBhc3NlZCAtIHRoZW4gc2V0IGl0XHJcbiAgICBpZiAocHJPcHRpb25zPy5kYXRhKSBtZS5fZGF0YSA9IHByT3B0aW9ucy5kYXRhO1xyXG5cclxuICAgIC8vIHNldHRpbmcgcGFyc2VyXHJcbiAgICBtZS5fbm9kZVBhcnNlciA9IHByT3B0aW9ucz8ubm9kZVBhcnNlciB8fCBtZS5vcHRpb25zLm5vZGVQYXJzZXI7XHJcblxyXG4gICAgLy8gYXBwbHlpbmcgb3B0aW9uc1xyXG4gICAgbWUub3B0aW9ucyA9IE9iamVjdC5hc3NpZ24obWUub3B0aW9ucywgcHJPcHRpb25zKTtcclxuXHJcbiAgICAvLyBtb25pdG9yIHJlc2l6ZVxyXG4gICAgZnJvbUV2ZW50KHByQ29udGFpbmVyLCAncmVzaXplJylcclxuICAgICAgLnBpcGUoXHJcbiAgICAgICAgZGVib3VuY2VUaW1lKDMwMClcclxuICAgICAgKS5zdWJzY3JpYmUoXHJcbiAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgLy8gSERDIC0gVkVSIHRoaXMucHJlcGFyZUNhbnZhcygpO1xyXG4gICAgICAgICAgY29uc29sZS5sb2coJ3Jlc2l6ZSBjb250YWluZXInKVxyXG4gICAgICAgICAgdGhpcy5yZW5kZXIoKTtcclxuICAgICAgICB9XHJcbiAgICAgIClcclxuICAgIGZyb21FdmVudCh3aW5kb3csICdyZXNpemUnKVxyXG4gICAgICAucGlwZShcclxuICAgICAgICBkZWJvdW5jZVRpbWUoMzAwKVxyXG4gICAgICApLnN1YnNjcmliZShcclxuICAgICAgICAoKSA9PiB7XHJcbiAgICAgICAgICAvLyBIREMgLSBWRVIgdGhpcy5wcmVwYXJlQ2FudmFzKCk7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZygncmVzaXplIHdpbmRvdycpXHJcbiAgICAgICAgICB0aGlzLnJlbmRlcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgKVxyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3QgbWUgPSB0aGlzO1xyXG4gICAgLy8gcHJlcGFyaW5nIHN2Z1xyXG4gICAgbWUucHJlcGFyZUNhbnZhcygpO1xyXG5cclxuICAgIC8vIGlmIG5vIGRhdGEgdGhlbiByZXR1cm5cclxuICAgIGlmICghbWUuZGF0YS5sZW5ndGgpIHJldHVybjtcclxuXHJcbiAgICAvLyBwcmVwYXJpbmcgZGF0YVxyXG4gICAgbWUucHJlcGFyZURhdGEoKTtcclxuXHJcbiAgICAvLyBzaG93aW5nIG5vZGVzXHJcbiAgICBtZS5zaG93Tm9kZXMoKTtcclxuICAgIHJldHVybiB0aGlzO1xyXG4gIH1cclxuXHJcbiAgLy8gcHJlcGFyaW5nIGNhbnZhc1xyXG4gIHByb3RlY3RlZCBwcmVwYXJlQ2FudmFzKCkge1xyXG4gICAgY29uc3QgbWUgPSB0aGlzO1xyXG5cclxuICAgIC8vRHJhd2luZyBjb250YWluZXJzXHJcbiAgICBjb25zdCBjb250YWluZXJSZWN0ID0gbWUuY29udGFpbmVyLm5vZGUoKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcbiAgICAvLyBjb25zb2xlLmxvZygnQ29udGFpbmVyIHJlc2N0OiAnLCBjb250YWluZXJSZWN0KVxyXG5cclxuICAgIG1lLnN2ZyA9IG1lLmNvbnRhaW5lci5zZWxlY3RBbGw8U1ZHRWxlbWVudCwgYW55Pignc3ZnJylcclxuICAgICAgLmRhdGEoW3sgaWQ6ICdzdmcnIH1dLCAoZDogeyBpZDogc3RyaW5nIH0pID0+IGQuaWQpXHJcbiAgICAgIC5qb2luKFxyXG4gICAgICAgIGVudGVyID0+XHJcbiAgICAgICAgICBlbnRlclxyXG4gICAgICAgICAgICAuYXBwZW5kKCdzdmcnKVxyXG4gICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnc3ZnLWNoYXJ0LWNvbnRhaW5lcicpXHJcbiAgICAgICAgICAgIC5hdHRyKCdmb250LWZhbWlseScsIG1lLm9wdGlvbnMuZGVmYXVsdEZvbnQpXHJcbiAgICAgICAgICAgIC8vIC5jYWxsKGQzLnpvb20oKS5vbihcInpvb21cIiwgZCA9PiB0aGlzLnpvb21lZCgpKSlcclxuICAgICAgICAgICAgLmNhbGwodGhpcy56b29tRnVuYylcclxuICAgICAgICAgICAgLm9uKFwiZGJsY2xpY2suem9vbVwiLCBudWxsKVxyXG4gICAgICAgICAgICAuYXR0cignY3Vyc29yJywgJ21vdmUnKVxyXG4gICAgICAgICAgICAuc3R5bGUoJ2JhY2tncm91bmQtY29sb3InLCBtZS5vcHRpb25zLmJhY2tncm91bmRDb2xvciksXHJcbiAgICAgICAgdXBkYXRlID0+XHJcbiAgICAgICAgICB1cGRhdGVcclxuICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgY29udGFpbmVyUmVjdC53aWR0aClcclxuICAgICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIGNvbnRhaW5lclJlY3QuaGVpZ2h0KVxyXG4gICAgICAgICAgICAuYXR0cignZm9udC1mYW1pbHknLCBtZS5vcHRpb25zLmRlZmF1bHRGb250KVxyXG4gICAgICAgICAgICAuc3R5bGUoJ2JhY2tncm91bmQtY29sb3InLCBtZS5vcHRpb25zLmJhY2tncm91bmRDb2xvcilcclxuICAgICAgKVxyXG4gICAgICAuYXR0cignd2lkdGgnLCBjb250YWluZXJSZWN0LndpZHRoKVxyXG4gICAgICAuYXR0cignaGVpZ2h0JywgY29udGFpbmVyUmVjdC5oZWlnaHQpXHJcbiAgICAgIC5hdHRyKCdmb250LWZhbWlseScsIG1lLm9wdGlvbnMuZGVmYXVsdEZvbnQpXHJcbiAgICAgIC5zdHlsZSgnYmFja2dyb3VuZC1jb2xvcicsIG1lLm9wdGlvbnMuYmFja2dyb3VuZENvbG9yKVxyXG4gICAgICA7XHJcblxyXG4gICAgLy9BZGQgY29udGFpbmVyIGcgZWxlbWVudFxyXG4gICAgbWUuY2hhcnQgPSBtZS5zdmcuc2VsZWN0QWxsPFNWR0dFbGVtZW50LCBhbnk+KCdnLmNoYXJ0JylcclxuICAgICAgLmRhdGEoW3sgaWQ6ICdjaGFydCcgfV0sIChkOiB7IGlkOiBzdHJpbmcgfSkgPT4gZC5pZClcclxuICAgICAgLmpvaW4oXHJcbiAgICAgICAgZW50ZXIgPT4gZW50ZXJcclxuICAgICAgICAgIC5hcHBlbmQoJ2cnKVxyXG4gICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NoYXJ0JylcclxuICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKDAsMClgKSxcclxuICAgICAgICB1cGRhdGUgPT4gdXBkYXRlXHJcbiAgICAgIClcclxuICAgIGlmICghbWUubGFzdFRyYW5zZm9ybSlcclxuICAgICAgbWUuc3ZnLnRyYW5zaXRpb24oKS5kdXJhdGlvbigyMDApLmNhbGwoXHJcbiAgICAgICAgbWUuem9vbUZ1bmMudHJhbnNmb3JtLFxyXG4gICAgICAgIGQzLnpvb21JZGVudGl0eS50cmFuc2xhdGUoY29udGFpbmVyUmVjdC53aWR0aCAvIDIsIHRoaXMubm9kZVBhcnNlci5oZWlnaHQpLnNjYWxlKDEpXHJcbiAgICAgICk7XHJcblxyXG4gICAgLy9BZGQgY29udGFpbmVyIGcgZWxlbWVudFxyXG4gICAgbWUudGIgPSBtZS5zdmcuc2VsZWN0QWxsKCdnLnRvb2xiYXInKVxyXG4gICAgICAuZGF0YShbeyBpZDogJ3Rvb2xiYXInIH1dLCAoZDogeyBpZDogc3RyaW5nIH0pID0+IGQuaWQpXHJcbiAgICAgIC5qb2luKFxyXG4gICAgICAgIGVudGVyID0+IGVudGVyXHJcbiAgICAgICAgICAuYXBwZW5kKCdnJylcclxuICAgICAgICAgIC5hdHRyKCdjbGFzcycsICd0b29sYmFyJylcclxuICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKDEwLDEwKWApXHJcbiAgICAgICAgICAuYXBwZW5kKCdyZWN0JylcclxuICAgICAgICAgIC5hdHRyKCd3aWR0aCcsIDMwKVxyXG4gICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIDMwKVxyXG4gICAgICAgICAgLmF0dHIoJ2ZpbGwnLCAndXJsKCNpbWctZml0LWljb24pJylcclxuICAgICAgICAgIC5hdHRyKCdjdXJzb3InLCAncG9pbnRlcicpXHJcbiAgICAgICAgICAub24oJ2NsaWNrJywgKCkgPT4gbWUuZml0KCkpLFxyXG4gICAgICAgIHVwZGF0ZSA9PiB1cGRhdGVcclxuICAgICAgKVxyXG4gICAgbWUucHJlcGFyZURlZnMoKTtcclxuICB9XHJcblxyXG4gIC8vIHByZXBhcmluZyBkZWZzXHJcbiAgcHJlcGFyZURlZnMoKSB7XHJcbiAgICBjb25zdCBtZSA9IHRoaXM7XHJcbiAgICAvLyBkZWZzXHJcbiAgICBtZS5kZWZzID0gbWUuc3ZnLnNlbGVjdEFsbCgnZGVmcy5nbG9iYWxEZWZzJylcclxuICAgICAgLmRhdGEoW3sgaWQ6ICdkZWZzJyB9XSwgKGQ6IHsgaWQ6IHN0cmluZyB9KSA9PiBkLmlkKVxyXG4gICAgICAuam9pbihcclxuICAgICAgICBlbnRlciA9PiB7XHJcbiAgICAgICAgICBjb25zdCBkZWZzID0gZW50ZXIuYXBwZW5kKCdkZWZzJykuYXR0cignY2xhc3MnLCAnZ2xvYmFsRGVmcycpO1xyXG4gICAgICAgICAgYWRkRGVmYXVsdERlZnMoZGVmcywge1xyXG4gICAgICAgICAgICAnZXhwYW5kLWljb24nOiB7XHJcbiAgICAgICAgICAgICAgdHlwZTogJ2ljb24nLFxyXG4gICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJyMwNUMzNTYnLFxyXG4gICAgICAgICAgICAgIHNjYWxlOiAwLjYsXHJcbiAgICAgICAgICAgICAgY29sb3I6ICcjRUFGQTQ4JyxcclxuICAgICAgICAgICAgICBuYW1lOiAnZmFQbHVzJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnY29sbGFwc2UtaWNvbic6IHtcclxuICAgICAgICAgICAgICB0eXBlOiAnaWNvbicsXHJcbiAgICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiAnI0QxMDMwMycsXHJcbiAgICAgICAgICAgICAgc2NhbGU6IDAuNixcclxuICAgICAgICAgICAgICBjb2xvcjogJyNFQUZBNDgnLFxyXG4gICAgICAgICAgICAgIG5hbWU6ICdmYU1pbnVzJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnZml0LWljb24nOiB7XHJcbiAgICAgICAgICAgICAgdHlwZTogJ2ljb24nLFxyXG4gICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJyMwNzRFRjMnLFxyXG4gICAgICAgICAgICAgIHNjYWxlOiAwLjksXHJcbiAgICAgICAgICAgICAgY29sb3I6ICcjRUFGQTQ4JyxcclxuICAgICAgICAgICAgICBuYW1lOiAnZmFFeHBhbmQnXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdkZWZhdWx0LW5vZGUtaW1nJzogbWUubm9kZVBhcnNlci5kZWZhdWx0SW1hZ2UgYXMgSUltYWdlRGVmXHJcbiAgICAgICAgICB9LCBtZS5ub2RlUGFyc2VyKVxyXG4gICAgICAgICAgLy9hZGREZWZzKGRlZnMsIG1lLmRlZnNFbGVtZW50cyk7XHJcbiAgICAgICAgICByZXR1cm4gZGVmc1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdXBkYXRlID0+IHVwZGF0ZVxyXG4gICAgICApXHJcbiAgfVxyXG5cclxuICAvLyBwcmVwYXJpbmcgZGF0YVxyXG4gIHByb3RlY3RlZCBwcmVwYXJlRGF0YSgpIHtcclxuICAgIGNvbnN0IG1lID0gdGhpcztcclxuXHJcbiAgICAvLyBpZiBubyBkYXRhIHJldHVybiBcclxuICAgIGlmICghbWUuZGF0YS5sZW5ndGgpIHJldHVybjtcclxuXHJcbiAgICAvLyBDb252ZXJ0IGZsYXQgZGF0YSB0byBoaWVyYXJjaGljYWxcclxuICAgIGlmICghbWUucm9vdCkge1xyXG4gICAgICB0cnkgeyAvLyBwcmV2ZW50aW5nIG11bHRpcGxlIHJvb3RcclxuICAgICAgICBtZS5yb290ID0gZDMuc3RyYXRpZnk8SUQzTm9kZT4oKS5pZCgoeyBub2RlSWQgfSkgPT4gbm9kZUlkKS5wYXJlbnRJZCgoeyBwYXJlbnROb2RlSWQgfSkgPT4gcGFyZW50Tm9kZUlkKVxyXG4gICAgICAgICAgKG1lLmRhdGEpIGFzIGQzLkhpZXJhcmNoeVBvaW50Tm9kZTxJRDNOb2RlPjtcclxuICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgbWUucm9vdCA9IGQzLnN0cmF0aWZ5PElEM05vZGU+KCkuaWQoKHsgbm9kZUlkIH0pID0+IG5vZGVJZCkucGFyZW50SWQoKHsgcGFyZW50Tm9kZUlkIH0pID0+IHBhcmVudE5vZGVJZClcclxuICAgICAgICAgIChbe1xyXG4gICAgICAgICAgICBub2RlSWQ6ICdyb290JyxcclxuICAgICAgICAgICAgcGFyZW50Tm9kZUlkOiAnJyxcclxuICAgICAgICAgICAgdGl0bGU6ICdFcnJvcicsXHJcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBlcnIubWVzc2FnZSB8fCBlcnIsXHJcbiAgICAgICAgICAgIG5vZGVJbWFnZToge1xyXG4gICAgICAgICAgICAgIHR5cGU6ICdiYXNlNjQnLFxyXG4gICAgICAgICAgICAgIGRhdGE6IG1lLm5vZGVQYXJzZXIuZXJyb3JCYXNlNjRJY29uXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1dKSBhcyBkMy5IaWVyYXJjaHlQb2ludE5vZGU8SUQzTm9kZT47XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBwcmVwYXJpbmcgdHJlZW1hcFxyXG4gICAgY29uc3QgY29udGFpbmVyUmVjdCA9IG1lLmNvbnRhaW5lci5ub2RlKCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICBtZS50cmVlbWFwID0gZDMudHJlZTxJRDNOb2RlPigpIC8vLnNpemUoW2NvbnRhaW5lclJlY3Qud2lkdGggfHwgMjUwLCBjb250YWluZXJSZWN0LmhlaWdodF0pXHJcbiAgICAgIC5ub2RlU2l6ZShbXHJcbiAgICAgICAgKG1lLm5vZGVQYXJzZXIud2lkdGggKyAodGhpcy5ub2RlUGFyc2VyLndpZHRoICogbWUub3B0aW9ucy5ub2RlSG9yaXpvbnRhbFNwYWNlU2NhbGUgfHwgMC41KSkgKiAwLFxyXG4gICAgICAgIChtZS5ub2RlUGFyc2VyLmhlaWdodCArICh0aGlzLm5vZGVQYXJzZXIuaGVpZ2h0ICogbWUub3B0aW9ucy5ub2RlVmVydGljYWxTcGFjZVNjYWxlIHx8IDAuOCkpICogMFxyXG4gICAgICBdKVxyXG4gICAgICAuc2VwYXJhdGlvbigoYTogZDMuSGllcmFyY2h5UG9pbnROb2RlPElEM05vZGU+LCBiOiBkMy5IaWVyYXJjaHlQb2ludE5vZGU8SUQzTm9kZT4pID0+IHtcclxuICAgICAgICByZXR1cm4gMVxyXG4gICAgICB9KVxyXG4gICAgLy8gbWUuYWxsTm9kZXMgPSBtZS50cmVlbWFwKG1lLnJvb3QpLmRlc2NlbmRhbnRzKCk7XHJcbiAgICBtZS5jaGVja0V4cGFuZGVkKG1lLnJvb3QpO1xyXG4gIH1cclxuXHJcbiAgLy8gc2hvd2luZyBub2Rlc1xyXG4gIHByb3RlY3RlZCBzaG93Tm9kZXMocHJOb2RlOiBkMy5IaWVyYXJjaHlQb2ludE5vZGU8SUQzTm9kZT4gPSBudWxsKSB7XHJcbiAgICBjb25zdCBtZSA9IHRoaXM7XHJcblxyXG4gICAgaWYgKCFwck5vZGUpIHByTm9kZSA9IG1lLnJvb3Q7XHJcbiAgICBjb25zdCBub2RlUmVmID0ge1xyXG4gICAgICB4OiBwck5vZGUueCB8fCAwLFxyXG4gICAgICB5OiBwck5vZGUueSB8fCAwLFxyXG4gICAgICBwYXJlbnQ6IHByTm9kZS5wYXJlbnRcclxuICAgIH07XHJcblxyXG4gICAgLy8gY29uc29sZS5sb2coJ05vZGUgQmVmb3JlOiAnLCBub2RlUmVmLngpO1xyXG4gICAgY29uc3QgdXBkYXRlUG9zaXRpb246IHsgeDogbnVtYmVyLCB5OiBudW1iZXIgfSA9IHtcclxuICAgICAgeDogcHJOb2RlLnggfHwgMCxcclxuICAgICAgeTogcHJOb2RlLnkgfHwgMFxyXG4gICAgfVxyXG5cclxuICAgIC8vICBBc3NpZ25zIHRoZSB4IGFuZCB5IHBvc2l0aW9uIGZvciB0aGUgbm9kZXNcclxuICAgIGNvbnN0IHRyZWVEYXRhID0gbWUudHJlZW1hcChtZS5yb290KTtcclxuICAgIC8vIGl0IGlzIG5lY2VzYXJ5IGZvciBzY29wZSBcclxuICAgIGNvbnN0IGRyYXdOb2RlcyA9IChjb250YWluZXIpID0+IG1lLm5vZGVQYXJzZXIuZHJhd05vZGVzKGNvbnRhaW5lciwgbWUub25Ob2RlQ2xpY2spO1xyXG4gICAgY29uc3QgZHJhd0NvbGxhcHNlciA9IChub2RlR3JvdXA6IGQzLlNlbGVjdGlvbjxTVkdHRWxlbWVudCwgZDMuSGllcmFyY2h5UG9pbnROb2RlPElEM05vZGU+LCBhbnksIGFueT4pID0+IHtcclxuICAgICAgbm9kZUdyb3VwLmFwcGVuZCgnY2lyY2xlJylcclxuICAgICAgICAuYXR0cignY2xhc3MnLCAnY29sbGFwc2VyJylcclxuICAgICAgICAuYXR0cignY3gnLCBtZS5ub2RlUGFyc2VyLndpZHRoIC8gMilcclxuICAgICAgICAuYXR0cignY3knLCBtZS5ub2RlUGFyc2VyLmhlaWdodClcclxuICAgICAgICAuYXR0cigncicsIDE1KVxyXG4gICAgICAgIC5hdHRyKCdzdHJva2UnLCAnYmxhY2snKVxyXG4gICAgICAgIC5hdHRyKCdzdHJva2Utd2lkdGgnLCAyKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAobm9kZSkgPT4ge1xyXG4gICAgICAgICAgLy8gY29uc29sZS5sb2coJ05vZGUgWDogJywgbm9kZS54KVxyXG4gICAgICAgICAgZDMuZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgIG1lLmV4cGFuZChub2RlLCB0cnVlKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvLyBjb25zb2xlLmxvZygnTm9kZSByZWY6ICcsIHByTm9kZS54LCBub2RlUmVmLngsIG5vZGVSZWYgKVxyXG4gICAgY29uc3Qgbm9kZXMgPSB0cmVlRGF0YS5kZXNjZW5kYW50cygpO1xyXG5cclxuICAgIC8vIHByb2JhbmRpbmdcclxuICAgIGJ1aWxkVHJlZShcclxuICAgICAgbWUucm9vdCxcclxuICAgICAge1xyXG4gICAgICAgIHc6IG1lLm5vZGVQYXJzZXIud2lkdGggKyAodGhpcy5ub2RlUGFyc2VyLndpZHRoICogbWUub3B0aW9ucy5ub2RlSG9yaXpvbnRhbFNwYWNlU2NhbGUgfHwgMC41KSxcclxuICAgICAgICBoOiBtZS5ub2RlUGFyc2VyLmhlaWdodCArICh0aGlzLm5vZGVQYXJzZXIuaGVpZ2h0ICogbWUub3B0aW9ucy5ub2RlVmVydGljYWxTcGFjZVNjYWxlIHx8IDAuOClcclxuICAgICAgfVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBjb25zb2xlLmxvZygnTm9kZXM6ICcsIG5vZGVzKTtcclxuICAgIC8vIHByZXBhcmluZyBhbGwgZGVmaW5pdGlvbnMgZm9yIG5vZGVzXHJcbiAgICBtZS5kZWZzLnNlbGVjdEFsbCgncGF0dGVybi5ub2RlJylcclxuICAgICAgLmRhdGEobm9kZXMsIChkOiBkMy5IaWVyYXJjaHlQb2ludE5vZGU8SUQzTm9kZT4pID0+IGQuZGF0YS5ub2RlSWQpXHJcbiAgICAgIC5qb2luKFxyXG4gICAgICAgIGVudGVyID0+XHJcbiAgICAgICAgICBlbnRlci5maWx0ZXIoZCA9PiBkLmRhdGEubm9kZUltYWdlICE9IG51bGwpXHJcbiAgICAgICAgICAgIC5hcHBlbmQoJ3BhdHRlcm4nKS5hdHRyKCdjbGFzcycsICdub2RlJylcclxuICAgICAgICAgICAgLmVhY2goKG5vZGVEYXRhLCBpLCBlbnRlck5vZGVzKSA9PiB7XHJcbiAgICAgICAgICAgICAgLy8gYWRkaW5nIHBhdHRlcm5cclxuICAgICAgICAgICAgICBjb25zdCBwYXR0ZXJuID0gZDMuc2VsZWN0KGVudGVyTm9kZXNbaV0pO1xyXG4gICAgICAgICAgICAgIHNldFBhdHRlcm4ocGF0dGVybiwgbm9kZURhdGEuZGF0YSwgbWUubm9kZVBhcnNlcik7XHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgIHVwZGF0ZSA9PiB1cGRhdGUsXHJcbiAgICAgICAgZXhpdCA9PiBleGl0XHJcbiAgICAgICAgICAudHJhbnNpdGlvbigpXHJcbiAgICAgICAgICAuZHVyYXRpb24obWUubm9kZVBhcnNlci50cmFuc2l0aW9uRHVyYXRpb24pXHJcbiAgICAgICAgICAuc3R5bGUoXCJvcGFjaXR5XCIsIDApXHJcbiAgICAgICAgICAucmVtb3ZlKClcclxuICAgICAgKVxyXG5cclxuICAgIC8vIHJlbmRlcmluZyBub2Rlc1xyXG4gICAgY29uc3Qgbm9kZVN0YXJ0UG9zaXRpb24gPSAoZDogZDMuSGllcmFyY2h5UG9pbnROb2RlPElEM05vZGU+KSA9PiB7XHJcbiAgICAgIGlmIChub2RlUmVmKSB7XHJcbiAgICAgICAgcmV0dXJuIGB0cmFuc2xhdGUoJHtub2RlUmVmLnggLSAobWUubm9kZVBhcnNlci53aWR0aCAvIDIpfSwke25vZGVSZWYueX0pYFxyXG4gICAgICB9XHJcbiAgICAgIGlmICghZC5wYXJlbnQpIHJldHVybiBgdHJhbnNsYXRlKCR7ZC54IC0gKG1lLm5vZGVQYXJzZXIud2lkdGggLyAyKX0sJHtkLnl9KWA7XHJcbiAgICAgIHJldHVybiBgdHJhbnNsYXRlKCR7ZC5wYXJlbnQueCAtIChtZS5ub2RlUGFyc2VyLndpZHRoIC8gMil9LCR7ZC5wYXJlbnQueX0pYFxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNvbGxhcHNlclN0YXJ0UG9zaXRpb24gPSAoZDogZDMuSGllcmFyY2h5UG9pbnROb2RlPElEM05vZGU+KSA9PiB7XHJcbiAgICAgIGlmIChub2RlUmVmKSByZXR1cm4gbm9kZVJlZjtcclxuICAgICAgaWYgKCFkLnBhcmVudCkgcmV0dXJuIGQ7XHJcbiAgICAgIHJldHVybiBkLnBhcmVudDtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBub2RlUG9zaXRpb24gPSAocGFyYW1zOiB7IHg6IG51bWJlciwgeTogbnVtYmVyIH0pID0+XHJcbiAgICAgIGB0cmFuc2xhdGUoJHtwYXJhbXMueCAtIChtZS5ub2RlUGFyc2VyLndpZHRoIC8gMil9LCR7cGFyYW1zLnl9KWA7XHJcblxyXG4gICAgY29uc3QgY29sbGFwc2VyUG9zaXRpb24gPSAocGFyYW1zOiB7IHg6IG51bWJlciwgeTogbnVtYmVyIH0pID0+XHJcbiAgICAgIGB0cmFuc2xhdGUoJHtwYXJhbXMueH0sJHtwYXJhbXMueX0pYDtcclxuXHJcbiAgICBjb25zdCBleHBhbmRJY29uVmlzaWJsZSA9XHJcbiAgICAgIChkOiBkMy5IaWVyYXJjaHlQb2ludE5vZGU8SUQzTm9kZT4gJiB7IF9jaGlsZHJlbj86IGFueSB9KSA9PiAoZC5jaGlsZHJlbiB8fCBkLl9jaGlsZHJlbikgPyAndmlzaWJsZScgOiAnaGlkZGVuJztcclxuICAgIGNvbnN0IGV4cGFuZEljb24gPVxyXG4gICAgICAoZDogZDMuSGllcmFyY2h5UG9pbnROb2RlPElEM05vZGU+ICYgeyBfY2hpbGRyZW4/OiBhbnkgfSkgPT4gZXhwYW5kSWNvblZpc2libGUoZCkgPT0gJ3Zpc2libGUnID8gKGQuZGF0YS5leHBhbmRlZCA/IGB1cmwoI2ltZy1jb2xsYXBzZS1pY29uKWAgOiBgdXJsKCNpbWctZXhwYW5kLWljb24pYCkgOiAnJztcclxuICAgIGNvbnN0IGNvbGxhcHNlckN1cnNvciA9XHJcbiAgICAgIChkOiBkMy5IaWVyYXJjaHlQb2ludE5vZGU8SUQzTm9kZT4gJiB7IF9jaGlsZHJlbj86IGFueSB9KSA9PiBleHBhbmRJY29uVmlzaWJsZShkKSA9PSAndmlzaWJsZScgPyAoZC5kYXRhLmV4cGFuZGVkID8gYHpvb20tb3V0YCA6IGB6b29tLWluYCkgOiAnZGVmYXVsdCc7XHJcblxyXG5cclxuICAgIG1lLmNoYXJ0LnNlbGVjdEFsbCgnZy5ub2RlJylcclxuICAgICAgLmRhdGEobm9kZXMsIChkOiBkMy5IaWVyYXJjaHlQb2ludE5vZGU8SUQzTm9kZT4pID0+IGQuZGF0YS5ub2RlSWQpXHJcbiAgICAgIC5qb2luKFxyXG4gICAgICAgIGVudGVyID0+XHJcbiAgICAgICAgICBlbnRlci5hcHBlbmQoJ2cnKVxyXG4gICAgICAgICAgICAuc3R5bGUoXCJvcGFjaXR5XCIsIDApXHJcbiAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdub2RlJylcclxuICAgICAgICAgICAgLmF0dHIoJ2N1cnNvcicsICdwb2ludGVyJylcclxuICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsIG5vZGVTdGFydFBvc2l0aW9uKVxyXG4gICAgICAgICAgICAuY2FsbChkcmF3Tm9kZXMpXHJcbiAgICAgICAgICAgIC8vIC5jYWxsKGRyYXdDb2xsYXBzZXIpXHJcbiAgICAgICAgICAgIC5vbignZGJsY2xpY2snLCAobm9kZSkgPT4ge1xyXG4gICAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSBtZS5jb250YWluZXIubm9kZSgpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgICAgICAgIG1lLnRyYXNsYXRlVG8oKGNvbnRhaW5lclJlY3Qud2lkdGggLyAyKSAtIG5vZGUueCwgKChjb250YWluZXJSZWN0LmhlaWdodCAtIG1lLm5vZGVQYXJzZXIuaGVpZ2h0KSAvIDIpIC0gbm9kZS55KVxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICB1cGRhdGUgPT4gdXBkYXRlLFxyXG4gICAgICAgIGV4aXQgPT5cclxuICAgICAgICAgIGV4aXRcclxuICAgICAgICAgICAgLnRyYW5zaXRpb24oKVxyXG4gICAgICAgICAgICAuZHVyYXRpb24obWUubm9kZVBhcnNlci50cmFuc2l0aW9uRHVyYXRpb24pXHJcbiAgICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCBub2RlUG9zaXRpb24ocHJOb2RlKSlcclxuICAgICAgICAgICAgLnN0eWxlKFwib3BhY2l0eVwiLCAwKVxyXG4gICAgICAgICAgICAucmVtb3ZlKClcclxuICAgICAgKVxyXG4gICAgICAudHJhbnNpdGlvbigpLmR1cmF0aW9uKG1lLm5vZGVQYXJzZXIudHJhbnNpdGlvbkR1cmF0aW9uKVxyXG4gICAgICAuc3R5bGUoXCJvcGFjaXR5XCIsIDEpXHJcbiAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCBub2RlUG9zaXRpb24pXHJcbiAgICAgIC8vLnNlbGVjdEFsbCgnY2lyY2xlLmNvbGxhcHNlcicpXHJcbiAgICAgIC8vLmF0dHIoJ3Zpc2liaWxpdHknLCBleHBhbmRJY29uVmlzaWJsZSlcclxuICAgICAgLy8uYXR0cignZmlsbCcsIGV4cGFuZEljb24pXHJcblxyXG4gICAgbWUuY2hhcnQuc2VsZWN0QWxsKCdjaXJjbGUuY29sbGFwc2VyJylcclxuICAgICAgLmRhdGEobm9kZXMsIChkOiBkMy5IaWVyYXJjaHlQb2ludE5vZGU8SUQzTm9kZT4pID0+IGQuZGF0YS5ub2RlSWQpXHJcbiAgICAgIC5qb2luKFxyXG4gICAgICAgIGVudGVyID0+XHJcbiAgICAgICAgICBlbnRlci5hcHBlbmQoJ2NpcmNsZScpXHJcbiAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY29sbGFwc2VyJylcclxuICAgICAgICAgIC5zdHlsZShcIm9wYWNpdHlcIiwgMClcclxuICAgICAgICAgIC5hdHRyKCdjeCcsIChkKSA9PiBjb2xsYXBzZXJTdGFydFBvc2l0aW9uKGQpLngpXHJcbiAgICAgICAgICAuYXR0cignY3knLCAoZCkgPT4gY29sbGFwc2VyU3RhcnRQb3NpdGlvbihkKS55ICsgbWUubm9kZVBhcnNlci5oZWlnaHQpXHJcbiAgICAgICAgICAuYXR0cigncicsIDE1KVxyXG4gICAgICAgICAgLmF0dHIoJ3N0cm9rZScsICdibGFjaycpXHJcbiAgICAgICAgICAuYXR0cignc3Ryb2tlLXdpZHRoJywgMilcclxuICAgICAgICAgIC5vbignY2xpY2snLCAobm9kZSkgPT4ge1xyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnTm9kZSBYOiAnLCBub2RlLngpXHJcbiAgICAgICAgICAgIGQzLmV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIG1lLmV4cGFuZChub2RlLCB0cnVlKTtcclxuICAgICAgICAgIH0pLFxyXG4gICAgICAgIHVwZGF0ZSA9PiB1cGRhdGUsXHJcbiAgICAgICAgZXhpdCA9PlxyXG4gICAgICAgICAgZXhpdFxyXG4gICAgICAgICAgICAudHJhbnNpdGlvbigpLmR1cmF0aW9uKG1lLm5vZGVQYXJzZXIudHJhbnNpdGlvbkR1cmF0aW9uKVxyXG4gICAgICAgICAgICAuYXR0cignY3gnLCAoZCkgPT4gY29sbGFwc2VyU3RhcnRQb3NpdGlvbihkKS54KVxyXG4gICAgICAgICAgICAuYXR0cignY3knLCAoZCkgPT4gY29sbGFwc2VyU3RhcnRQb3NpdGlvbihkKS55ICsgbWUubm9kZVBhcnNlci5oZWlnaHQpXHJcbiAgICAgICAgICAgIC5zdHlsZShcIm9wYWNpdHlcIiwgMClcclxuICAgICAgICAgICAgLnJlbW92ZSgpXHJcbiAgICAgIClcclxuICAgICAgLnRyYW5zaXRpb24oKS5kdXJhdGlvbihtZS5ub2RlUGFyc2VyLnRyYW5zaXRpb25EdXJhdGlvbilcclxuICAgICAgLnN0eWxlKFwib3BhY2l0eVwiLCAxKVxyXG4gICAgICAuYXR0cignY3gnLCAoZCkgPT4gZC54KVxyXG4gICAgICAuYXR0cignY3knLCAoZCkgPT4gZC55ICsgbWUubm9kZVBhcnNlci5oZWlnaHQpXHJcbiAgICAgIC5hdHRyKCd2aXNpYmlsaXR5JywgZXhwYW5kSWNvblZpc2libGUpXHJcbiAgICAgIC5hdHRyKCdmaWxsJywgZXhwYW5kSWNvbilcclxuICAgICAgLmF0dHIoJ2N1cnNvcicsIGNvbGxhcHNlckN1cnNvcilcclxuXHJcblxyXG5cclxuICAgIC8vIHJlbmRlcmluZyBsaW5rc1xyXG4gICAgY29uc3QgcGF0aFN0YXJ0aW5nRGlhZ29uYWwgPSAoZDogeyB4OiBudW1iZXIsIHk6IG51bWJlciwgcGFyZW50OiBJUm9vdE5vZGU8SUQzTm9kZT4gfSkgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5saW5rUGF0aChkLCBkKVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHBhdGhEaWFnb25hbCA9IChkOiBJUm9vdE5vZGU8SUQzTm9kZT4pID0+IHtcclxuICAgICAgY29uc3QgdGFyZ2V0ID0geyB4OiBkLnBhcmVudC54LCB5OiBkLnBhcmVudC55ICsgbWUubm9kZVBhcnNlci5oZWlnaHQgfTtcclxuICAgICAgcmV0dXJuIHRoaXMubGlua1BhdGgoZCwgZC5wYXJlbnQpXHJcbiAgICB9XHJcblxyXG4gICAgbWUuY2hhcnQuc2VsZWN0QWxsKCdwYXRoLmxpbmsnKVxyXG4gICAgICAuZGF0YShub2Rlcy5zbGljZSgxKSwgKGQ6IGQzLkhpZXJhcmNoeVBvaW50Tm9kZTxJRDNOb2RlPikgPT4gZC5kYXRhLm5vZGVJZClcclxuICAgICAgLmpvaW4oXHJcbiAgICAgICAgZW50ZXIgPT5cclxuICAgICAgICAgIGVudGVyXHJcbiAgICAgICAgICAgIC5pbnNlcnQoJ3BhdGgnLCAnZycpXHJcbiAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdsaW5rJylcclxuICAgICAgICAgICAgLmF0dHIoJ2ZpbGwnLCAnbm9uZScpXHJcbiAgICAgICAgICAgIC5hdHRyKCdzdHJva2UnLCAnYmx1ZScpXHJcbiAgICAgICAgICAgIC5hdHRyKCdzdHJva2Utd2lkdGgnLCAyKVxyXG4gICAgICAgICAgICAuYXR0cignZCcsIHBhdGhTdGFydGluZ0RpYWdvbmFsKG5vZGVSZWYpKSxcclxuICAgICAgICB1cGRhdGUgPT4gdXBkYXRlLFxyXG4gICAgICAgIGV4aXQgPT5cclxuICAgICAgICAgIGV4aXRcclxuICAgICAgICAgICAgLnRyYW5zaXRpb24oKS5kdXJhdGlvbihtZS5ub2RlUGFyc2VyLnRyYW5zaXRpb25EdXJhdGlvbilcclxuICAgICAgICAgICAgLmF0dHIoJ2QnLCBwYXRoU3RhcnRpbmdEaWFnb25hbChwck5vZGUpKVxyXG4gICAgICAgICAgICAucmVtb3ZlKClcclxuICAgICAgKVxyXG4gICAgICAudHJhbnNpdGlvbigpLmR1cmF0aW9uKG1lLm5vZGVQYXJzZXIudHJhbnNpdGlvbkR1cmF0aW9uKVxyXG4gICAgICAuYXR0cignZCcsIHBhdGhEaWFnb25hbCk7XHJcbiAgfVxyXG5cclxuICAvLyBab29tIGhhbmRsZXIgZnVuY3Rpb25cclxuICB6b29tZWQoKSB7XHJcbiAgICBjb25zdCBtZSA9IHRoaXM7XHJcbiAgICAvLyBTYXZpbmcgZDMgZXZlbnQncyB0cmFuc2Zvcm0gb2JqZWN0XHJcbiAgICBtZS5sYXN0VHJhbnNmb3JtID0gZDMuZXZlbnQudHJhbnNmb3JtO1xyXG4gICAgLy8gUmVwb3NpdGlvbiBhbmQgcmVzY2FsZSBjaGFydCBhY2NvcmRpbmdseVxyXG4gICAgaWYgKGlzTmFOKG1lLmxhc3RUcmFuc2Zvcm0uaykgfHwgaXNOYU4obWUubGFzdFRyYW5zZm9ybS54KSB8fCBpc05hTihtZS5sYXN0VHJhbnNmb3JtLnkpKSByZXR1cm47XHJcblxyXG4gICAgbWUuY2hhcnQuYXR0cigndHJhbnNmb3JtJywgZDMuZXZlbnQudHJhbnNmb3JtKTtcclxuICB9XHJcblxyXG4gIC8vI3JlZ2lvbiBFdmVudHNcclxuICAvLyBub2RlIGNsaWNrXHJcbiAgb25Ob2RlQ2xpY2s6IFN1YmplY3Q8eyBpZDogc3RyaW5nLCBub2RlOiBJRDNOb2RlIH0+ID0gbmV3IFN1YmplY3QoKTtcclxuICBwcm90ZWN0ZWQgX29uTm9kZUNsaWNrKG5vZGVJZDogc3RyaW5nLCBub2RlOiBJRDNOb2RlKSB7XHJcbiAgICB0aGlzLm9uTm9kZUNsaWNrLm5leHQoeyBpZDogbm9kZUlkLCBub2RlOiBub2RlIH0pO1xyXG4gIH1cclxuICAvLyNlbmRyZWdpb25cclxuXHJcbiAgLy8gR2VuZXJhdGUgY3VzdG9tIGRpYWdvbmFsIC0gcGxheSB3aXRoIGl0IGhlcmUgLSBodHRwczovL29ic2VydmFibGVocS5jb20vQGJ1bWJlaXNodmlsaS9jdXJ2ZWQtZWRnZXM/Y29sbGVjdGlvbj1AYnVtYmVpc2h2aWxpL3dvcmstY29tcG9uZW50c1xyXG4gIGxpbmtQYXRoKHNvdXJjZTogeyB4OiBudW1iZXIsIHk6IG51bWJlciwgcGFyZW50OiBJUm9vdE5vZGU8SUQzTm9kZT4gfSwgdGFyZ2V0OiB7IHg6IG51bWJlciwgeTogbnVtYmVyLCBwYXJlbnQ6IElSb290Tm9kZTxJRDNOb2RlPiB9KSB7XHJcbiAgICBjb25zdCBtZSA9IHRoaXM7XHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIHNvbWUgdmFyaWFibGVzIGJhc2VkIG9uIHNvdXJjZSBhbmQgdGFyZ2V0IChzLHQpIGNvb3JkaW5hdGVzXHJcbiAgICBsZXQgeCA9IHNvdXJjZS54O1xyXG4gICAgbGV0IHkgPSBzb3VyY2UueTtcclxuICAgIGNvbnN0IGV4ID0gdGFyZ2V0Lng7XHJcbiAgICBjb25zdCBleSA9IHRhcmdldC55ICsgbWUubm9kZVBhcnNlci5oZWlnaHQ7XHJcblxyXG4gICAgY29uc3QgbGlua0hlaWdodCA9IDI1O1xyXG4gICAgY29uc3QgY3VydmVSYWRpdXMgPSBNYXRoLmFicyh4IC0gZXgpICE9IDAgPyAxNSA6IDA7XHJcblxyXG4gICAgbGV0IHhydnMgPSBleCAtIHggPCAwID8gLTEgOiAxO1xyXG4gICAgbGV0IHlydnMgPSBleSAtIHkgPCAwID8gLTEgOiAxO1xyXG4gICAgbGV0IHcgPSBNYXRoLmFicyhleCAtIHgpIC0gKGN1cnZlUmFkaXVzICogMik7XHJcblxyXG4gICAgY29uc3QgcGF0aCA9IGBcclxuICAgICAgTSAke3h9ICR7eX1cclxuICAgICAgTCAke3h9ICR7eSArIChsaW5rSGVpZ2h0ICogeXJ2cyl9XHJcbiAgICAgIEMgJHt4fSAke3kgKyAoKGxpbmtIZWlnaHQgKyBjdXJ2ZVJhZGl1cykgKiB5cnZzKX0gJHt4fSAke3kgKyAoKGxpbmtIZWlnaHQgKyBjdXJ2ZVJhZGl1cykgKiB5cnZzKX0gJHt4ICsgKGN1cnZlUmFkaXVzICogeHJ2cyl9ICR7eSArICgobGlua0hlaWdodCArIGN1cnZlUmFkaXVzKSAqIHlydnMpfVxyXG4gICAgICBMICR7eCArICgodyArIGN1cnZlUmFkaXVzKSAqIHhydnMpfSAke3kgKyAoKGxpbmtIZWlnaHQgKyBjdXJ2ZVJhZGl1cykgKiB5cnZzKX1cclxuICAgICAgQyAke2V4fSAgJHt5ICsgKChsaW5rSGVpZ2h0ICsgY3VydmVSYWRpdXMpICogeXJ2cyl9ICR7ZXh9ICAke3kgKyAoKGxpbmtIZWlnaHQgKyBjdXJ2ZVJhZGl1cykgKiB5cnZzKX0gJHtleH0gJHt5ICsgKChsaW5rSGVpZ2h0ICsgY3VydmVSYWRpdXMpICogeXJ2cykgKyAoY3VydmVSYWRpdXMgKiB5cnZzKX1cclxuICAgICAgTCAke2V4fSAke2V5fVxyXG4gICAgYDtcclxuICAgIHJldHVybiBwYXRoO1xyXG4gIH1cclxuXHJcbiAgY2hlY2tFeHBhbmRlZChub2RlOiBkMy5IaWVyYXJjaHlQb2ludE5vZGU8SUQzTm9kZT4gJiB7IF9jaGlsZHJlbj86IGFueSB9KSB7XHJcbiAgICBjb25zdCBtZSA9IHRoaXM7XHJcblxyXG4gICAgLy8gY2hlY2tpbmcgZXhwYW5kZWRcclxuICAgIGlmIChub2RlLmRhdGEuZXhwYW5kZWQpIHtcclxuICAgICAgaWYgKCFub2RlLmNoaWxkcmVuICYmIG5vZGUuX2NoaWxkcmVuKSB7XHJcbiAgICAgICAgbm9kZS5jaGlsZHJlbiA9IG5vZGUuX2NoaWxkcmVuO1xyXG4gICAgICAgIG5vZGUuX2NoaWxkcmVuID0gbnVsbDtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHsgLy8gY29sbGFwc2VkXHJcbiAgICAgIGlmIChub2RlLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgbm9kZS5fY2hpbGRyZW4gPSBub2RlLmNoaWxkcmVuO1xyXG4gICAgICAgIG5vZGUuY2hpbGRyZW4gPSBudWxsO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBjaGVja2luZyBjaGlsZHJlblxyXG4gICAgKG5vZGUuY2hpbGRyZW4gfHwgbm9kZS5fY2hpbGRyZW4gfHwgW10pLmZvckVhY2goY3VycmVudCA9PiBtZS5jaGVja0V4cGFuZGVkKGN1cnJlbnQpKVxyXG4gIH1cclxuXHJcbiAgZXhwYW5kKG5vZGU6IGQzLkhpZXJhcmNoeVBvaW50Tm9kZTxJRDNOb2RlPiAmIHsgX2NoaWxkcmVuPzogYW55IH0sIHRvZ2dsZTogYm9vbGVhbiA9IGZhbHNlKSB7IC8vLCAgcmVuZGVyOiBib29sZWFuID0gZmFsc2UpIHtcclxuICAgIGNvbnN0IG1lID0gdGhpcztcclxuXHJcbiAgICBjb25zdCBub2RlUmVmID0gT2JqZWN0LmFzc2lnbihub2RlKTtcclxuXHJcbiAgICAvLyBpZiB0b2dnbGUgLSBsZXRzIHRvZ2dsZVxyXG4gICAgaWYgKHRvZ2dsZSkgbm9kZS5kYXRhLmV4cGFuZGVkID0gIW5vZGUuZGF0YS5leHBhbmRlZDtcclxuXHJcbiAgICAvLyBjaGVja2luZyBleHBhbmRlZFxyXG4gICAgaWYgKG5vZGUuZGF0YS5leHBhbmRlZCkge1xyXG4gICAgICBpZiAoIW5vZGUuY2hpbGRyZW4gJiYgbm9kZS5fY2hpbGRyZW4pIHtcclxuICAgICAgICBub2RlLmNoaWxkcmVuID0gbm9kZS5fY2hpbGRyZW47XHJcbiAgICAgICAgbm9kZS5fY2hpbGRyZW4gPSBudWxsO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2UgeyAvLyBjb2xsYXBzZWRcclxuICAgICAgaWYgKG5vZGUuY2hpbGRyZW4pIHtcclxuICAgICAgICBub2RlLl9jaGlsZHJlbiA9IG5vZGUuY2hpbGRyZW47XHJcbiAgICAgICAgbm9kZS5jaGlsZHJlbiA9IG51bGw7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBleHBhbmQobm9kZS5jaGlsZHJlbiwgbm9kZS5kYXRhLmV4cGFuZGVkKTtcclxuICAgIC8vIGNvbnNvbGUubG9nKCdCZWZvcmUgZXhwYW5kOiAnLCBub2RlUmVmLngsICBub2RlLngpXHJcbiAgICBpZiAodG9nZ2xlKSBtZS5zaG93Tm9kZXMobm9kZSk7XHJcbiAgfVxyXG5cclxuICB0cmFzbGF0ZVRvKHByWCwgcHJZKSB7XHJcbiAgICBjb25zdCBtZSA9IHRoaXM7XHJcbiAgICBtZS5zdmdcclxuICAgICAgLnRyYW5zaXRpb24oKS5kdXJhdGlvbihtZS5ub2RlUGFyc2VyLnRyYW5zaXRpb25EdXJhdGlvbilcclxuICAgICAgLmNhbGwoXHJcbiAgICAgICAgbWUuem9vbUZ1bmMudHJhbnNmb3JtLFxyXG4gICAgICAgIGQzLnpvb21JZGVudGl0eS50cmFuc2xhdGUocHJYLCBwclkpXHJcbiAgICAgICk7XHJcbiAgfVxyXG5cclxuICBmaXQoKSB7XHJcbiAgICBjb25zdCBtZSA9IHRoaXM7XHJcbiAgICAvLyBjb25zdCB6b29tID0gZDMuem9vbSgpLm9uKFwiem9vbVwiLCBkID0+IHRoaXMuem9vbWVkKCkpXHJcbiAgICBpZiAoIW1lLnJvb3QpIHJldHVybjtcclxuXHJcbiAgICBjb25zdCBmaXQgPSBjYWxjR0ZpdChtZS5jaGFydCwgbWUuc3ZnLCBtZS5yb290LCBtZS5ub2RlUGFyc2VyKVxyXG4gICAgbWUuc3ZnLnRyYW5zaXRpb24oKS5kdXJhdGlvbihtZS5ub2RlUGFyc2VyLnRyYW5zaXRpb25EdXJhdGlvbikuY2FsbChcclxuICAgICAgbWUuem9vbUZ1bmMudHJhbnNmb3JtLFxyXG4gICAgICBkMy56b29tSWRlbnRpdHkudHJhbnNsYXRlKGZpdC54LCBmaXQueSkuc2NhbGUoZml0LnNjYWxlKVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHNldE9wdGlvbnMocHJPcHRpb25zOiBQYXJ0aWFsPElEM09yZ0NoYXJ0T3B0aW9ucz4pIHtcclxuICAgIGNvbnN0IG1lID0gdGhpcztcclxuICAgIG1lLm9wdGlvbnMgPSBPYmplY3QuYXNzaWduKG1lLm9wdGlvbnMsIHByT3B0aW9ucyk7XHJcbiAgfVxyXG59XHJcblxyXG4iXX0=