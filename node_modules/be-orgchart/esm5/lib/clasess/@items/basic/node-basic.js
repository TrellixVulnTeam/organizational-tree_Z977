// getting base64 icons
import { errorBase64Data } from './../../../assets/icons/error.base64';
var D3NodeBasicParser = /** @class */ (function () {
    function D3NodeBasicParser() {
        // dimensions
        this.width = 240;
        this.height = 100;
        this.frame = {
            type: 'rect',
            className: 'node-rect',
            width: this.width,
            height: this.height,
            stroke: 'blue',
            "stroke-width": 2,
            fill: '#02B2AC',
            rx: 5
        };
        this.defaultImage = {
            type: 'link',
            data: "https://raw.githubusercontent.com/hdcolelia/be-orgchart/master/src/lib/assets/images/root.png"
        };
        // error icon
        this.errorBase64Icon = errorBase64Data;
        this.imageDefs = {
            x: -20, y: -15, h: 60, w: 60, rx: 60
        };
        this.transitionDuration = 600;
    }
    D3NodeBasicParser.prototype.drawNodes = function (prGroup, prClickEvent) {
        var me = this;
        // adding rect
        me.addRect(prGroup, me.frame);
        //.on('click', (node) => {
        //  prClickEvent.next({ id: node.data.nodeId, node: node.data });
        //})
        // adding title
        me.addText(prGroup, { type: 'text', className: 'title', refField: 'title', x: 50, y: 25, "font-size": 15 });
        me.addText(prGroup, { type: 'text', className: 'description', refField: 'description', x: 50, y: 45, "font-size": 10 });
        me.addText(prGroup, { type: 'text', className: 'description', refField: 'nodeId', x: 50, y: 70, "font-size": 8 });
        // adding image
        var imageUrl = function (d) {
            if (d.data.nodeImage)
                return "url(#img-" + d.data.nodeId + ")";
            if (me.defaultImage)
                return "url(#img-default-node-img)";
            return '';
        };
        prGroup.filter(function (d) { return imageUrl(d) != ''; })
            .append('rect').attr('class', 'node-image')
            .attr('x', me.imageDefs.x).attr('y', me.imageDefs.y)
            .attr('width', me.imageDefs.w).attr('height', me.imageDefs.h)
            .attr('fill', function (d) { return imageUrl(d); }).attr('rx', me.imageDefs.rx);
        // .on('click', (node) => {
        //   prClickEvent.next({ id: node.data.nodeId, node: node.data });
        // });
        // adding click receptor
        prGroup.on('click', function (node) {
            prClickEvent.next({ id: node.data.nodeId, node: node.data });
        });
    };
    //#region adding components
    D3NodeBasicParser.prototype.addRect = function (gNode, rect) {
        return this.addComponent(gNode, rect);
    };
    D3NodeBasicParser.prototype.addText = function (gNode, text) {
        return this.addComponent(gNode, text);
    };
    D3NodeBasicParser.prototype.addComponent = function (gNode, component) {
        var el = gNode.append(component.type);
        el.attr('class', component.className);
        var _loop_1 = function (key) {
            switch (key) {
                case 'refField':
                    el.text(function (d) { return d.data[component[key]]; });
                default:
                    el.attr(key, component[key]);
            }
        };
        for (var key in component) {
            _loop_1(key);
        }
        return el;
    };
    return D3NodeBasicParser;
}());
export { D3NodeBasicParser };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm9kZS1iYXNpYy5qcyIsInNvdXJjZVJvb3QiOiJuZzovL2JlLW9yZ2NoYXJ0LyIsInNvdXJjZXMiOlsibGliL2NsYXNlc3MvQGl0ZW1zL2Jhc2ljL25vZGUtYmFzaWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBR0EsdUJBQXVCO0FBQ3ZCLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxzQ0FBc0MsQ0FBQztBQUl2RTtJQUNFO1FBRUEsYUFBYTtRQUNiLFVBQUssR0FBVyxHQUFHLENBQUM7UUFDcEIsV0FBTSxHQUFXLEdBQUcsQ0FBQztRQUVyQixVQUFLLEdBQXVCO1lBQzFCLElBQUksRUFBRSxNQUFNO1lBQ1osU0FBUyxFQUFFLFdBQVc7WUFDdEIsS0FBSyxFQUFFLElBQUksQ0FBQyxLQUFLO1lBQ2pCLE1BQU0sRUFBRSxJQUFJLENBQUMsTUFBTTtZQUNuQixNQUFNLEVBQUUsTUFBTTtZQUNkLGNBQWMsRUFBRSxDQUFDO1lBQ2pCLElBQUksRUFBRSxTQUFTO1lBQ2YsRUFBRSxFQUFFLENBQUM7U0FDTixDQUFBO1FBRUQsaUJBQVksR0FBZTtZQUN6QixJQUFJLEVBQUUsTUFBTTtZQUNaLElBQUksRUFBRSwrRkFBK0Y7U0FDdEcsQ0FBQTtRQUVELGFBQWE7UUFDYixvQkFBZSxHQUFHLGVBQWUsQ0FBQztRQUVsQyxjQUFTLEdBQStEO1lBQ3RFLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFO1NBQ3JDLENBQUE7UUFFRCx1QkFBa0IsR0FBVyxHQUFHLENBQUM7SUE3QmpCLENBQUM7SUErQmpCLHFDQUFTLEdBQVQsVUFDRSxPQUE0RSxFQUM1RSxZQUFvRDtRQUVwRCxJQUFNLEVBQUUsR0FBRyxJQUFJLENBQUM7UUFFaEIsY0FBYztRQUNkLEVBQUUsQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQyxLQUFL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Q2hILElBQU0sRUFBRSxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3hDLEVBQUUsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLFNBQVMsQ0FBQyxTQUFTLENBQUMsQ0FBQztnQ0FFM0IsR0FBRztZQUNaLFFBQVEsR0FBRyxFQUFFO2dCQUNYLEtBQUssVUFBVTtvQkFDYixFQUFFLENBQUMsSUFBSSxDQUFDLFVBQUEsQ0FBQyxJQUFJLE9BQUEsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBdEIsQ0FBc0IsQ0FBQyxDQUFDO2dCQUN2QztvQkFDRSxFQUFFLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQzthQUNoQzs7UUFOSCxLQUFLLElBQU0sR0FBRyxJQUFJLFNBQVM7b0JBQWhCLEdBQUc7U0FPYjtRQUNELE9BQU8sRUFBRSxDQUFDO0lBQ1osQ0FBQztJQUVILHdCQUFDO0FBQUQsQ0FBQyxBQTlGRCxJQThGQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGQzIGZyb20gJ2QzJztcclxuaW1wb3J0IHsgSUQzTm9kZSwgSUltYWdlRGVmIH0gZnJvbSAnLi8uLi8uLi8uLi9pbnRlcmZhY2VzJztcclxuXHJcbi8vIGdldHRpbmcgYmFzZTY0IGljb25zXHJcbmltcG9ydCB7IGVycm9yQmFzZTY0RGF0YSB9IGZyb20gJy4vLi4vLi4vLi4vYXNzZXRzL2ljb25zL2Vycm9yLmJhc2U2NCc7XHJcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgSU5vZGVDb21wb25lbnRSZWN0LCBJTm9kZUNvbXBvbmVudCwgSU5vZGVDb21wb25lbnRUZXh0IH0gZnJvbSAnLi4vLi4vLi4vaW50ZXJmYWNlcy9ub2RlLWl0ZW0nO1xyXG5cclxuZXhwb3J0IGNsYXNzIEQzTm9kZUJhc2ljUGFyc2VyIHtcclxuICBjb25zdHJ1Y3RvcigpIHsgfVxyXG5cclxuICAvLyBkaW1lbnNpb25zXHJcbiAgd2lkdGg6IG51bWJlciA9IDI0MDtcclxuICBoZWlnaHQ6IG51bWJlciA9IDEwMDtcclxuXHJcbiAgZnJhbWU6IElOb2RlQ29tcG9uZW50UmVjdCA9IHtcclxuICAgIHR5cGU6ICdyZWN0JyxcclxuICAgIGNsYXNzTmFtZTogJ25vZGUtcmVjdCcsXHJcbiAgICB3aWR0aDogdGhpcy53aWR0aCxcclxuICAgIGhlaWdodDogdGhpcy5oZWlnaHQsXHJcbiAgICBzdHJva2U6ICdibHVlJyxcclxuICAgIFwic3Ryb2tlLXdpZHRoXCI6IDIsXHJcbiAgICBmaWxsOiAnIzAyQjJBQycsXHJcbiAgICByeDogNVxyXG4gIH1cclxuXHJcbiAgZGVmYXVsdEltYWdlPzogSUltYWdlRGVmID0ge1xyXG4gICAgdHlwZTogJ2xpbmsnLFxyXG4gICAgZGF0YTogXCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vaGRjb2xlbGlhL2JlLW9yZ2NoYXJ0L21hc3Rlci9zcmMvbGliL2Fzc2V0cy9pbWFnZXMvcm9vdC5wbmdcIlxyXG4gIH1cclxuXHJcbiAgLy8gZXJyb3IgaWNvblxyXG4gIGVycm9yQmFzZTY0SWNvbiA9IGVycm9yQmFzZTY0RGF0YTtcclxuXHJcbiAgaW1hZ2VEZWZzOiB7IHg6IG51bWJlciwgeTogbnVtYmVyLCBoOiBudW1iZXIsIHc6IG51bWJlciwgcng6IG51bWJlciB9ID0ge1xyXG4gICAgeDogLTIwLCB5OiAtMTUsIGg6IDYwLCB3OiA2MCwgcng6IDYwXHJcbiAgfVxyXG5cclxuICB0cmFuc2l0aW9uRHVyYXRpb246IG51bWJlciA9IDYwMDtcclxuXHJcbiAgZHJhd05vZGVzKFxyXG4gICAgcHJHcm91cDogZDMuU2VsZWN0aW9uPFNWR0dFbGVtZW50LCBkMy5IaWVyYXJjaHlQb2ludE5vZGU8SUQzTm9kZT4sIGFueSwgYW55PixcclxuICAgIHByQ2xpY2tFdmVudDogU3ViamVjdDx7IGlkOiBzdHJpbmcsIG5vZGU6IElEM05vZGUgfT5cclxuICApIHtcclxuICAgIGNvbnN0IG1lID0gdGhpcztcclxuXHJcbiAgICAvLyBhZGRpbmcgcmVjdFxyXG4gICAgbWUuYWRkUmVjdChwckdyb3VwLCBtZS5mcmFtZSk7XHJcbiAgICAvLy5vbignY2xpY2snLCAobm9kZSkgPT4ge1xyXG4gICAgLy8gIHByQ2xpY2tFdmVudC5uZXh0KHsgaWQ6IG5vZGUuZGF0YS5ub2RlSWQsIG5vZGU6IG5vZGUuZGF0YSB9KTtcclxuICAgIC8vfSlcclxuXHJcbiAgICAvLyBhZGRpbmcgdGl0bGVcclxuICAgIG1lLmFkZFRleHQocHJHcm91cCwgeyB0eXBlOiAndGV4dCcsIGNsYXNzTmFtZTogJ3RpdGxlJywgcmVmRmllbGQ6ICd0aXRsZScsIHg6IDUwLCB5OiAyNSwgXCJmb250LXNpemVcIjogMTUgfSlcclxuICAgIG1lLmFkZFRleHQocHJHcm91cCwgeyB0eXBlOiAndGV4dCcsIGNsYXNzTmFtZTogJ2Rlc2NyaXB0aW9uJywgcmVmRmllbGQ6ICdkZXNjcmlwdGlvbicsIHg6IDUwLCB5OiA0NSwgXCJmb250LXNpemVcIjogMTAgfSlcclxuICAgIG1lLmFkZFRleHQocHJHcm91cCwgeyB0eXBlOiAndGV4dCcsIGNsYXNzTmFtZTogJ2Rlc2NyaXB0aW9uJywgcmVmRmllbGQ6ICdub2RlSWQnLCB4OiA1MCwgeTogNzAsIFwiZm9udC1zaXplXCI6IDggfSlcclxuXHJcbiAgICAvLyBhZGRpbmcgaW1hZ2VcclxuICAgIGNvbnN0IGltYWdlVXJsID0gKGQ6IGQzLkhpZXJhcmNoeVBvaW50Tm9kZTxJRDNOb2RlPikgPT4ge1xyXG4gICAgICBpZiAoZC5kYXRhLm5vZGVJbWFnZSkgcmV0dXJuIGB1cmwoI2ltZy0ke2QuZGF0YS5ub2RlSWR9KWA7XHJcbiAgICAgIGlmIChtZS5kZWZhdWx0SW1hZ2UpIHJldHVybiBgdXJsKCNpbWctZGVmYXVsdC1ub2RlLWltZylgO1xyXG4gICAgICByZXR1cm4gJyc7XHJcbiAgICB9XHJcbiAgICBwckdyb3VwLmZpbHRlcihkID0+IGltYWdlVXJsKGQpICE9ICcnKVxyXG4gICAgICAuYXBwZW5kKCdyZWN0JykuYXR0cignY2xhc3MnLCAnbm9kZS1pbWFnZScpXHJcbiAgICAgIC5hdHRyKCd4JywgbWUuaW1hZ2VEZWZzLngpLmF0dHIoJ3knLCBtZS5pbWFnZURlZnMueSlcclxuICAgICAgLmF0dHIoJ3dpZHRoJywgbWUuaW1hZ2VEZWZzLncpLmF0dHIoJ2hlaWdodCcsIG1lLmltYWdlRGVmcy5oKVxyXG4gICAgICAuYXR0cignZmlsbCcsIGQgPT4gaW1hZ2VVcmwoZCkpLmF0dHIoJ3J4JywgbWUuaW1hZ2VEZWZzLnJ4KVxyXG4gICAgICAvLyAub24oJ2NsaWNrJywgKG5vZGUpID0+IHtcclxuICAgICAgLy8gICBwckNsaWNrRXZlbnQubmV4dCh7IGlkOiBub2RlLmRhdGEubm9kZUlkLCBub2RlOiBub2RlLmRhdGEgfSk7XHJcbiAgICAgIC8vIH0pO1xyXG4gICAgXHJcbiAgICAvLyBhZGRpbmcgY2xpY2sgcmVjZXB0b3JcclxuICAgIHByR3JvdXAub24oJ2NsaWNrJywgKG5vZGUpID0+IHtcclxuICAgICAgcHJDbGlja0V2ZW50Lm5leHQoeyBpZDogbm9kZS5kYXRhLm5vZGVJZCwgbm9kZTogbm9kZS5kYXRhIH0pO1xyXG4gICAgfSkgICAgICBcclxuICB9XHJcblxyXG4gIC8vI3JlZ2lvbiBhZGRpbmcgY29tcG9uZW50c1xyXG4gIGFkZFJlY3QoZ05vZGU6IGQzLlNlbGVjdGlvbjxTVkdHRWxlbWVudCwgZDMuSGllcmFyY2h5UG9pbnROb2RlPElEM05vZGU+LCBhbnksIGFueT4sIHJlY3Q6IElOb2RlQ29tcG9uZW50UmVjdCkge1xyXG4gICAgcmV0dXJuIHRoaXMuYWRkQ29tcG9uZW50KGdOb2RlLCByZWN0KTtcclxuICB9XHJcblxyXG4gIGFkZFRleHQoZ05vZGU6IGQzLlNlbGVjdGlvbjxTVkdHRWxlbWVudCwgZDMuSGllcmFyY2h5UG9pbnROb2RlPElEM05vZGU+LCBhbnksIGFueT4sIHRleHQ6IElOb2RlQ29tcG9uZW50VGV4dCkge1xyXG4gICAgcmV0dXJuIHRoaXMuYWRkQ29tcG9uZW50KGdOb2RlLCB0ZXh0KTtcclxuICB9XHJcblxyXG4gIGFkZENvbXBvbmVudChnTm9kZTogZDMuU2VsZWN0aW9uPFNWR0dFbGVtZW50LCBkMy5IaWVyYXJjaHlQb2ludE5vZGU8SUQzTm9kZT4sIGFueSwgYW55PiwgY29tcG9uZW50OiBJTm9kZUNvbXBvbmVudCkge1xyXG4gICAgY29uc3QgZWwgPSBnTm9kZS5hcHBlbmQoY29tcG9uZW50LnR5cGUpO1xyXG4gICAgZWwuYXR0cignY2xhc3MnLCBjb21wb25lbnQuY2xhc3NOYW1lKTtcclxuXHJcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBjb21wb25lbnQpIHtcclxuICAgICAgc3dpdGNoIChrZXkpIHtcclxuICAgICAgICBjYXNlICdyZWZGaWVsZCc6XHJcbiAgICAgICAgICBlbC50ZXh0KGQgPT4gZC5kYXRhW2NvbXBvbmVudFtrZXldXSk7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgIGVsLmF0dHIoa2V5LCBjb21wb25lbnRba2V5XSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBlbDtcclxuICB9XHJcbiAgLy8jZW5kcmVnaW9uXHJcbn0iXX0=